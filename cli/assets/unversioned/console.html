<html lang="en-us">
  <head>
    <link
      rel="icon"
      type="image/png"
      href="https://graphql-engine-cdn.hasura.io/console/assets/common/img/favicon_green.png"
    />
    <script>
       window.__env = {
         apiHost: {{.apiHost}},
         apiPort: "{{.apiPort}}",
         cliVersion: {{.cliVersion}},
         dataApiUrl: {{.dataApiUrl}},
         dataApiVersion: {{.dataApiVersion}},
         {{- if .hasAccessKey }}
         accessKey: {{.adminSecret}},
         {{ else }}
         adminSecret: {{.adminSecret}},
         {{ end -}}
         urlPrefix: "/",
         consoleMode: "cli",
         cliUUID: {{.cliUUID}},
         enableTelemetry: {{.enableTelemetry}},
         assetsPath: "https://graphql-engine-cdn.hasura.io/console/assets",
         assetsVersion: "{{.assetsVersion}}",
         cdnAssets: {{.cdnAssets}},
         serverVersion: "{{.serverVersion}}",
       };
      window.__env.versionedAssetsPath = window.__env.assetsPath;
    </script>
  </head>
  <body>
    <style>
      .mainContent {
        display: "none";
        opacity: 0;
        transition: opacity 0.2s linear;
      }
      .mainContent.show {
        display: "block";
        opacity: 1;
        transition: opacity 0.2s linear;
      }
    </style>

    <div id="loading">
      <div
        class="page-loading"
        style="
      min-height: 100vh;
      width: 100%;
      display: flex;
      align-items: center;
      font-family: sans-serif;
      justify-content: center;
      "
      >
        <span
          class=""
          style="
        font-size: 2em;
        margin-top: -3em;
        color: #848484;
        "
        >
          Loading...
        </span>
      </div>
    </div>
    <div id="content" class="mainContent"></div>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />

    {{ if .cliStaticDir }}

    <link rel="stylesheet" href="/static/main.css" charset="UTF-8" />
    <script src="/static/vendor.js" charset="UTF-8"></script>
    <script src="/static/main.js" charset="UTF-8"></script>

    {{ else }}
    <script>
      // helper functions
      const loadIcon = url => {
        linkElem = document.createElement("link");
        linkElem.rel = "icon";
        linkElem.type = "image/png";
        linkElem.href = url;
        document.head.append(linkElem);
      };
      const loadCSS = url => {
        linkElem = document.createElement("link");
        linkElem.rel = "stylesheet";
        linkElem.charset = "UTF-8";
        linkElem.href = url;
        document.body.append(linkElem);
      };
      const loadScript = url => {
        scriptElem = document.createElement("script");
        scriptElem.charset = "UTF-8";
        scriptElem.src = url;
        document.body.append(scriptElem);
      };
      const prependSlash = str => (str === "" ? "" : "/" + str);
      const loadAssets = () => {
        loadCSS(
          window.__env.assetsPath + "/common/css/font-awesome.min.css.gz"
        );
        isCdnAssets = window.__env.cdnAssets;
        loadIcon(
          window.__env.assetsPath +
            `/common/img/favicon_green.png ${isCdnAssets ? ".gz" : ""}`
        );
        loadCSS(
          window.__env.versionedAssetsPath +
            `/main.css${isCdnAssets ? ".gz" : ""}`
        );
        loadScript(
          window.__env.versionedAssetsPath +
            `/main.js${isCdnAssets ? ".gz" : ""}`
        );
        loadScript(
          window.__env.versionedAssetsPath +
            `/vendor.js${isCdnAssets ? ".gz" : ""}`
        );
      };

      // if cdnAssets is set to false, load assets from server instead of cdn
      if (window.__env.cdnAssets === false) {
        window.__env.assetsPath =
          window.location.pathname.slice(
            0,
            window.location.pathname.lastIndexOf(window.__env.consolePath)
          ) + "/static/assets";
        // set the path to get versioned assets from server
        window.__env.versionedAssetsPath =
          window.__env.assetsPath + "/versioned";

        // otherwise load from cdn itself
      } else {
        // set the path (cdn-based) to get assets from
        window.__env.versionedAssetsPath =
          window.__env.assetsPath + prependSlash(window.__env.assetsVersion);
      }
      // load the assets now
      loadAssets();
    </script>

    {{ end }}
  </body>
</html>
